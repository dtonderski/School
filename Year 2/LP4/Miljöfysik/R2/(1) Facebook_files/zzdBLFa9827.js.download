if (self.CavalryLogger) { CavalryLogger.start_js(["VQVIm"]); }

__d("SphericalPhotoComposerTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("spherical_photo_composer:SphericalPhotoComposerLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("spherical_photo_composer:SphericalPhotoComposerLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("spherical_photo_composer:SphericalPhotoComposerLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setClientUserID=function(a){this.$1.client_userid=a;return this};c.setComposerSessionID=function(a){this.$1.composer_session_id=a;return this};c.setCountry=function(a){this.$1.country=a;return this};c.setDeltaTime=function(a){this.$1.delta_time=a;return this};c.setErrorMessage=function(a){this.$1.error_message=a;return this};c.setErrorMessageHash=function(a){this.$1.error_message_hash=a;return this};c.setErrorStackTrace=function(a){this.$1.error_stack_trace=a;return this};c.setIsemployee=function(a){this.$1.isemployee=a;return this};c.setName=function(a){this.$1.name=a;return this};c.setNumberOfMagicTags=function(a){this.$1.number_of_magic_tags=a;return this};c.setNumberOfPhoto=function(a){this.$1.number_of_photo=a;return this};c.setNumberOfSphericalPhoto=function(a){this.$1.number_of_spherical_photo=a;return this};c.setNumberOfTags=function(a){this.$1.number_of_tags=a;return this};c.setPhotoID=function(a){this.$1.photo_id=a;return this};c.setPitch=function(a){this.$1.pitch=a;return this};c.setProjectionType=function(a){this.$1.projection_type=a;return this};c.setSessionPhotoID=function(a){this.$1.session_photo_id=a;return this};c.setSourceHeight=function(a){this.$1.source_height=a;return this};c.setSourceProjectionType=function(a){this.$1.source_projection_type=a;return this};c.setSourceWidth=function(a){this.$1.source_width=a;return this};c.setSurface=function(a){this.$1.surface=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVfov=function(a){this.$1.vfov=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.setYaw=function(a){this.$1.yaw=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={client_userid:!0,composer_session_id:!0,country:!0,delta_time:!0,error_message:!0,error_message_hash:!0,error_stack_trace:!0,isemployee:!0,name:!0,number_of_magic_tags:!0,number_of_photo:!0,number_of_spherical_photo:!0,number_of_tags:!0,photo_id:!0,pitch:!0,projection_type:!0,session_photo_id:!0,source_height:!0,source_projection_type:!0,source_width:!0,surface:!0,time:!0,vfov:!0,weight:!0,yaw:!0};e.exports=a}),null);
__d("SphericalMediaViewportAnimation",["SphericalMediaViewActions","easeInOutInterpolate","requestAnimationFrame"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("SphericalMediaViewActions").startAnimating,h=b("SphericalMediaViewActions").stopAnimating,i=b("SphericalMediaViewActions").updateViewportAndFOV,j=1e3;a={moveTo:function(a){__p&&__p();return function(c,d){__p&&__p();var e=d(),f=e.view;if(f.isAnimating)return;c(g());var k=Date.now(),l=a.yaw-f.yaw;Math.abs(l)>180&&(l+=l>0?-360:360);var m=null,n=null,o=null,p=function a(e){__p&&__p();var f=d();f=f.view;if(!f.isAnimating)return;var g=Date.now();if(g-k>j||m!=null&&m!=f.pitch||n!=null&&n!=f.yaw||o!=null&&o!=f.fov){c(h());return}b("requestAnimationFrame")(function(){a(e)});f=b("easeInOutInterpolate")((g-k)/j);g=e.deltaPitch*f+e.startPitch;var l=e.deltaYaw*f+e.startYaw;f=e.deltaFov*f+e.startFov;c(i(l,g,f));m=g;n=l;o=f};b("requestAnimationFrame")(function(){p({startYaw:f.yaw,deltaYaw:l,startPitch:f.pitch,deltaPitch:a.pitch-f.pitch,startFov:f.fov,deltaFov:a.fov-f.fov})})}}};e.exports=a}),null);
__d("SphericalMediaMouseOverlay.redux",["React","ReactRedux","SphericalMediaBaseActions","SphericalMediaMouseOverlay.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("ReactRedux").connect;var g=b("SphericalMediaBaseActions").mouseAnimationStart,h=4e3,i=4e3;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={isActive:!1},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.UNSAFE_componentWillReceiveProps=function(a){!this.$1&&!this.state.isActive&&a.isSetup&&a.visibility&&!a.hasInteracted&&this.$2(),this.$1&&(!a.isSetup||!a.visibility)&&(clearTimeout(this.$1),this.setState({isActive:!1}),this.$1=null)};d.componentWillUnmount=function(){clearTimeout(this.$1),this.setState({isActive:!1}),this.$1=null};d.$2=function(){var a=this;this.$1=setTimeout(function(){a.setState({isActive:!0}),a.$1=setTimeout(function(){a.setState({isActive:!1}),a.$1=null},i),a.props.dispatch(g())},h)};d.render=function(){var a=this.state.isActive&&!this.props.hasInteracted;return b("React").createElement(b("SphericalMediaMouseOverlay.react"),{isActive:a})};return c}(b("React").PureComponent);d=function(a){return{isSetup:a.base.isRendererSetup,hasInteracted:a.base.hasInteracted,visibility:a.base.visibility}};e.exports=a(d)(c)}),null);
__d("SphericalPhotoHeadingIndicator.redux",["FullScreen","ReactRedux","SphericalMediaBaseActions","SphericalMediaHeadingIndicator.react","SphericalMediaViewportAnimation","SphericalPhotoPartialLimits","SphericalPhotoProjectionUtils","SphericalPhotoTypedConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("ReactRedux").connect;var g=b("SphericalMediaBaseActions").tapHeadingIndicator,h=b("SphericalMediaViewportAnimation").moveTo;b("SphericalPhotoPartialLimits").makePartialLimits;c={__onClick:!0,__getDrawData:!0};d=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$SphericalPhotoHeadingIndicator1=function(){c.draw(c.__getDrawData())},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){a.prototype.componentDidMount.call(this),this.props.viewStore.subscribe(this.$SphericalPhotoHeadingIndicator1)};d.__onClick=function(a){this.props.dispatch(g());var c=this.props.initialFov;if(this.props.showNewPhotoRenderer&&c>179){var d=this.props,e=d.aspectRatio;d=d.partialLimits;d&&(c=b("SphericalPhotoProjectionUtils").getMaxVfov(d,e))}this.props.viewStore.dispatch(h({fov:c,pitch:this.props.initialPitch,yaw:this.props.initialYaw}));a.stopPropagation()};d.__getDrawData=function(){var a=this.props.viewStore.getState();a=a.view;return{fov:a.fov,initialYaw:this.props.initialYaw,yaw:a.yaw}};return c}(b("SphericalMediaHeadingIndicator.react"));d.__subClassMethods=c;f=function(a){return{aspectRatio:a.base.aspectRatio,initialFov:a.base.initialFov,initialPitch:a.base.initialPitch,initialYaw:a.base.initialYaw,isActive:a.base.isRendererActive&&a.base.isRendererSetup||a.base.showFallbackUI,viewStore:a.base.viewStore,useLargeHeadingIndicator:a.base.useLargeHeadingIndicator||b("FullScreen").isFullScreen(),isPanning:a.base.isPanning,partialLimits:a.base.partialLimits,showNewPhotoRenderer:a.base.tiledSphericalConfig.useTiledRenderer&&b("SphericalPhotoTypedConfig").show_new_renderer}};e.exports=a(f)(d)}),null);
__d("SphericalPhotoComposerEvents",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CANVAS_RESIZE_START:"spherical_photo_www_canvas_resize_start",CANVAS_RESIZE_IMG_LOADED:"spherical_photo_www_canvas_resize_img_loaded",CANVAS_RESIZE_SUCCESS:"spherical_photo_www_canvas_resize_success",CANVAS_RESIZE_FAILED:"spherical_photo_www_canvas_resize_failed",GL_INIT_FAILURE:"spherical_photo_gl_init_failure",GL_CONTEXT_LOST:"spherical_photo_gl_context_lost",GL_RENDER_FAILURE:"spherical_photo_gl_render_failure",IVS_DRAG_START:"spherical_photo_ivs_drag_start",IVS_SET:"spherical_photo_ivs_set",IVS_TOGGLE_OFF:"spherical_photo_ivs_toggle_off",IVS_TOGGLE_ON:"spherical_photo_ivs_toggle_on",POST:"spherical_photo_post",SERVER_IVS_UPDATE_DONE:"spherical_photo_server_ivs_update_done",SERVER_IVS_UPDATE_FAILED:"spherical_photo_server_ivs_update_failed",SERVER_IVS_UPDATE_START:"spherical_photo_server_ivs_update_start",TAG_CANCEL:"spherical_photo_tag_cancel",TAG_CHANGES_FROM_COMPOSER:"spherical_photo_tag_changes_from_composer",TAG_CLICK_LABEL:"spherical_photo_tag_click_label",TAG_CLICK_TO_TAG:"spherical_photo_tag_click_to_tag",TAG_CREATE:"spherical_photo_tag_create",TAG_CREATE_FROM_FACEBOX:"spherical_photo_tag_create_from_facebox",TAG_DELETE:"spherical_photo_tag_delete",TAG_OPEN_DIALOG:"spherical_photo_tag_open_dialog",TAG_SAVE:"spherical_photo_tag_save",WWW_IVS_CANCEL:"spherical_photo_www_ivs_cancel",WWW_IVS_DISABLE_ON_SAVE:"spherical_photo_www_ivs_disable_on_save",WWW_IVS_ENABLE_ON_SAVE:"spherical_photo_www_ivs_enable_on_save",WWW_IVS_OPEN:"spherical_photo_www_ivs_open",WWW_IVS_REQUEST_DONE:"spherical_photo_www_ivs_request_done",WWW_IVS_REQUEST_FAILED:"spherical_photo_www_ivs_request_failed",WWW_IVS_REQUEST_START:"spherical_photo_www_ivs_request_start",WWW_IVS_UPDATE_DONE:"spherical_photo_www_ivs_update_done",WWW_IVS_UPDATE_FAILED:"spherical_photo_www_ivs_update_failed",WWW_IVS_UPDATE_START:"spherical_photo_www_ivs_update_start",SERVER_RENDER_PROJ_UPDATE_DONE:"spherical_photo_server_renderer_projection_update_done",SERVER_RENDER_PROJ_UPDATE_FAILED:"spherical_photo_server_renderer_projection_update_failed",SERVER_RENDER_PROJ_UPDATE_START:"spherical_photo_server_renderer_projection_update_start",SERVER_INVALID_METADATA:"spherical_photo_server_invalid_metadata"})}),null);
__d("SphericalPhotoTagLoggingUtil",["SphericalMediaActions","SphericalPhotoComposerEvents","SphericalPhotoComposerTypedLogger","SphericalMediaConstants"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("SphericalPhotoComposerTypedLogger"))(),h=b("SphericalMediaConstants").UNTAGGED_FACEBOX;a=function(a,c){__p&&__p();g.clear().setComposerSessionID(c.sessionID).setPhotoID(c.fbid).setProjectionType(c.projectionType).setSurface(c.surface);var d=0,e=0;switch(a.type){case b("SphericalMediaActions").UPDATE_SPATIAL_TAGS_FROM_COMPOSER:c=a.data;c.forEach(function(a){a.type!==h&&e++,a.isMagicFaceboxTag&&d++});g.setName(b("SphericalPhotoComposerEvents").TAG_CHANGES_FROM_COMPOSER).setNumberOfTags(e).setNumberOfMagicTags(d).log();break;case b("SphericalMediaActions").DELETED_SPATIAL_TAG:g.setName(b("SphericalPhotoComposerEvents").TAG_DELETE).log();break;case b("SphericalMediaActions").SAVE_DIALOG_TAGS:c=a.data;c.forEach(function(a){a.type!==h&&e++,a.isMagicFaceboxTag&&d++});g.setName(b("SphericalPhotoComposerEvents").TAG_SAVE).setNumberOfTags(e).setNumberOfMagicTags(d).log();break;case b("SphericalMediaActions").CANCEL_DIALOG_TAG_CHANGES:g.setName(b("SphericalPhotoComposerEvents").TAG_CANCEL).log();break;case b("SphericalMediaActions").REDIRECT_FROM_CLICKED_TAG:g.setName(b("SphericalPhotoComposerEvents").TAG_CLICK_LABEL).log();break;case b("SphericalMediaActions").OPEN_TAG_DIALOG:g.setName(b("SphericalPhotoComposerEvents").TAG_OPEN_DIALOG).log();break;case b("SphericalMediaActions").TAGGING_START:g.setName(b("SphericalPhotoComposerEvents").TAG_CLICK_TO_TAG).log();break;case b("SphericalMediaActions").ADD_SPATIAL_TAG_FROM_PHOTO_TAGGER:g.setName(b("SphericalPhotoComposerEvents").TAG_CREATE).log();break}};e.exports={log:a}}),null);
__d("SphericalPhotoViewerLoggingUtil",["SphericalMediaActions","SphericalPhotoViewerLogEvents","SphericalPhotoViewerTypedLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("SphericalPhotoViewerTypedLogger"))();a=function(a,c){__p&&__p();g.clear().setSphericalPhotoSessionID(c.sessionID).setPhotoID(c.fbid).setSurface(c.surface);var d,e;switch(a.type){case b("SphericalMediaActions").DRAG_START:g.setName(b("SphericalPhotoViewerLogEvents").DRAG_START).log();break;case b("SphericalMediaActions").GYRO_START:g.setName(b("SphericalPhotoViewerLogEvents").WWW_GYRO_START).log();break;case b("SphericalMediaActions").ZOOM_START:g.setName(b("SphericalPhotoViewerLogEvents").ZOOM_START).log();break;case b("SphericalMediaActions").SIGNIFICANT_MOVE:e=c.viewStore.getState().view;g.setName(b("SphericalPhotoViewerLogEvents").SIGNIFICANT_MOVEMENT).setYaw(e.yaw).setPitch(e.pitch).setVfov(e.fov).setViewportWidth(c.width).setViewportHeight(c.height).log();break;case b("SphericalMediaActions").MOUSE_ENTER:g.setName(b("SphericalPhotoViewerLogEvents").MOUSEOVER_START).log();break;case b("SphericalMediaActions").TAP_HEADING_INDICATOR:g.setName(b("SphericalPhotoViewerLogEvents").TAP_HEADING_INDICATOR).log();break;case b("SphericalMediaActions").MOUSE_ANIMATION_START:g.setName(b("SphericalPhotoViewerLogEvents").DRAG_MOUSE_ANIMATION).log();break;case b("SphericalMediaActions").SETUP_RENDERER:g.setName(b("SphericalPhotoViewerLogEvents").RENDERER_SETUP).setDt(a.data.dt).setRenderMethod(c.tiledSphericalConfig.useTiledRenderer?"tiled":"cubestrip").log();break;case b("SphericalMediaActions").WEBGL_RENDER_FAILED:d=a.data.error;e=c.viewStore.getState().view;g.setName(b("SphericalPhotoViewerLogEvents").WEBGL_RENDER_FAILURE).setErrorMessage(d.message).setRenderMethod(c.tiledSphericalConfig.useTiledRenderer?"tiled":"cubestrip").setYaw(e.yaw).setPitch(e.pitch).setVfov(e.fov).setViewportWidth(c.width).setViewportHeight(c.height).setErrorStackTrace(d.stack&&d.stack.split&&d.stack.split("at ")[1]).log();break;case b("SphericalMediaActions").WEBGL_CONTEXT_LOST:g.setName(b("SphericalPhotoViewerLogEvents").WEBGL_CONTEXT_LOST).log();break;case b("SphericalMediaActions").WEBGL_INIT_FAILED:d=a.data.error;g.setName(b("SphericalPhotoViewerLogEvents").WEBGL_INIT_FAILURE).setErrorMessage(d.message).setRenderMethod(c.tiledSphericalConfig.useTiledRenderer?"tiled":"cubestrip").setViewportWidth(c.width).setViewportHeight(c.height).setErrorStackTrace(d.stack&&d.stack.split&&d.stack.split("at ")[1]).log();break;case b("SphericalMediaActions").PHOTO_RENDERER_STATS:g.updateData(a.data).setName(b("SphericalPhotoViewerLogEvents").RENDERER_STATS).log();break}};e.exports={log:a}}),null);